<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.troytan.ymcake.repository.ProductMapper">
	<resultMap id="BaseResultMap" type="com.troytan.ymcake.domain.Product">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="PRODUCT_ID" jdbcType="INTEGER" property="productId" />
		<result column="img_url" jdbcType="VARCHAR" property="imgUrl" />
		<result column="price" jdbcType="DECIMAL" property="price" />
		<result column="name" jdbcType="VARCHAR" property="name" />
		<result column="description" jdbcType="VARCHAR" property="description" />
		<result column="created_on" jdbcType="TIMESTAMP" property="createdOn" />
		<result column="created_by" jdbcType="VARCHAR" property="createdBy" />
		<result column="updated_on" jdbcType="TIMESTAMP" property="updatedOn" />
		<result column="updated_by" jdbcType="VARCHAR" property="updatedBy" />
		<result column="detail_url" jdbcType="VARCHAR" property="detailUrl" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="Long">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from tt_product
		where PRODUCT_ID = #{productId,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.troytan.ymcake.domain.Product">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<selectKey keyProperty="productId" order="AFTER" resultType="Long">
			SELECT LAST_INSERT_ID()
		</selectKey>
		insert into tt_product (img_url, price, name,
		description, created_on,
		created_by,
		updated_on, updated_by, detail_url
		)
		values
		(#{imgUrl,jdbcType=VARCHAR}, #{price,jdbcType=DECIMAL},
		#{name,jdbcType=VARCHAR},
		#{description,jdbcType=VARCHAR},
		#{createdOn,jdbcType=TIMESTAMP}, #{createdBy,jdbcType=VARCHAR},
		#{updatedOn,jdbcType=TIMESTAMP}, #{updatedBy,jdbcType=VARCHAR},
		#{detailUrl,jdbcType=VARCHAR}
		)
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.troytan.ymcake.domain.Product">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update tt_product
		set img_url = #{imgUrl,jdbcType=VARCHAR},
		price =
		#{price,jdbcType=DECIMAL},
		name = #{name,jdbcType=VARCHAR},
		description
		= #{description,jdbcType=VARCHAR},
		created_on =
		#{createdOn,jdbcType=TIMESTAMP},
		created_by =
		#{createdBy,jdbcType=VARCHAR},
		updated_on =
		#{updatedOn,jdbcType=TIMESTAMP},
		updated_by =
		#{updatedBy,jdbcType=VARCHAR},
		detail_url =
		#{detailUrl,jdbcType=VARCHAR}
		where PRODUCT_ID =
		#{productId,jdbcType=INTEGER}
	</update>
	<select id="selectByPrimaryKey" parameterType="Long" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select PRODUCT_ID, img_url, price, name, description, created_on,
		created_by, updated_on,
		updated_by, detail_url
		from tt_product
		where
		PRODUCT_ID = #{productId,jdbcType=INTEGER}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select PRODUCT_ID, img_url, price, name, description, created_on,
		created_by, updated_on,
		updated_by, detail_url
		from tt_product
	</select>

	<resultMap id="ProductVoResultMap" type="com.troytan.ymcake.vo.ProductVo">
		<id column="PRODUCT_ID" jdbcType="INTEGER" property="productId" />
		<result column="name" jdbcType="VARCHAR" property="title" />
		<result column="description" jdbcType="VARCHAR" property="description" />
		<result column="detail_url" jdbcType="VARCHAR" property="detailUrl" />
		<collection ofType="com.troytan.ymcake.domain.ProductPic"
			property="productPicList">
			<id column="PRODUCT_PIC_ID" jdbcType="INTEGER" property="productPicId" />
			<result column="img_url" jdbcType="VARCHAR" property="imgUrl" />
		</collection>
		<collection ofType="com.troytan.ymcake.domain.Size"
			property="sizeList">
			<id column="SIZE_ID" jdbcType="INTEGER" property="sizeId" />
			<result column="size_desc" jdbcType="VARCHAR" property="description" />
			<result column="price" jdbcType="DECIMAL" property="price" />
		</collection>
	</resultMap>
	<!-- 获取单个product详情 -->
	<select id="selectVoByPrimaryKey" resultMap="ProductVoResultMap"
		parameterType="Long">
		select product.PRODUCT_ID, product.name,
		product.description,product.detail_url, pic.PRODUCT_PIC_ID,
		pic.img_url ,size.SIZE_ID,size.description as size_desc, size.price
		from tt_product product
		left join tt_size size on size.PRODUCT_ID = product.PRODUCT_ID
		left join tt_product_pic pic on pic.PRODUCT_ID = product.PRODUCT_ID
		where product.PRODUCT_ID=#{productId, jdbcType=DECIMAL}
	</select>
</mapper>